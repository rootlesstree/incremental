<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/app.css" rel="stylesheet">
    <title> Incremental Demo </title>
    <style>
    div {
        border-style: solid;
    }
    </style>
    </head>

<body>
<nav class="navbar navbar-default">
aloha
</nav>

<div class='col-md-6'></div>



<script src="http://d3js.org/d3.v3.min.js"></script>

<script>
var radius = 25;

window.states = [
    { x : 43, y : 67, label : "first" },
    { x : 340, y : 150, label : "second" },
    { x : 200, y : 250, label : "third" },
    { x : 300, y : 320, label : "fourth" },
    { x : 50, y : 250, label : "fifth" },
    { x : 90, y : 170, label : "last" }
]



var diameter = 960,
    format = d3.format(",d"),
    color = d3.scale.category20c();

var bubble = d3.layout.pack()
    .sort(null)
    .size([diameter, diameter])
    .padding(1.5);

var drag = d3.behavior.drag()
    .on("drag",function(d,i){
        var selection = d3.selectAll('.selected');
        if(selection[0].indexOf(this)){
            selection.classed("selected",false);
            selection = d3.select(this);
            selection.classed("selected",true);
        }

    selection.attr("transform", function( d, i) {
        d.x += d3.event.dx;
        d.y += d3.event.dy;
        return "translate(" + [ d.x,d.y ] + ")"
    })
        this.parentNode.appendChild(this);
        d3.event.sourceEvent.stopPropagation();
    });


var svg = d3.select("body div").append("svg")
    .attr("width", diameter)
    .attr("height", diameter)
    .attr("class", "bubble");

svg.on('mousedown',function() {
if(!d3.event.ctrlKey) {
    d3.selectAll('.selected').classed('selected',false);
}

var p = d3.mouse(this);


})

var gStates = svg.selectAll('g.state').data(states);

var gState = gStates.enter().append( "g")
    .attr({
        "transform" : function( d) {
            return "translate("+ [d.x,d.y] + ")";
        },
        'class'     : 'state' 
    })
;
    
gState.append( "circle")
    .attr({
        r       : radius + 4,
        class   : 'outer'
    })
;
gState.append( "circle")
    .attr({
        r       : radius,
        class   : 'inner'
    })
    .on( "click", function( d, i) {
        var e = d3.event,
            g = this.parentNode,
            isSelected = d3.select( g).classed( "selected");

        if( !e.ctrlKey) {
            d3.selectAll( 'g.selected').classed( "selected", false);
        }
        
        d3.select( g).classed( "selected", !isSelected);

            // reappend dragged element as last 
            // so that its stays on top 
        g.parentNode.appendChild( g);
    })
    .on("mouseover", function(){
        d3.select(this).style( "fill", "aliceblue");
    })
    .on("mouseout", function() { 
        d3.select(this).style("fill", "white");
    });
;        

gState.call(drag);
</script>

</body>

</html>
